2010-11-05  Jose E. Marchesi  <jemarch@gnu.org>

	* TODO: First serious version.

	* tasktool: Fixed many problems and 'delete' command implemented.

2010-11-03  Jose E. Marchesi  <jemarch@gnu.org>

	recfix: little fixes.
	* utils/recfix.c (main): Use EXIT_SUCCESS and EXIT_FAILURE.
	(recfix_process_data): Fix wrong comparison.

2010-11-02  Jose E. Marchesi  <jemarch@gnu.org>

	Generate manpages using help2man.
	* configure.ac: Generate man/Makefile.

	* man/Makefile.am: New file.

	* configure.ac: Search for help2man if not cross-compiling.

2010-11-01  Jose E. Marchesi  <jemarch@gnu.org>

	Syntax check problems fixed.
	* src/rec-writer.c: Include config.h.
	* torture/runtests.c: Likewise.

	* tasktool: Use test ... && test ... instead of test ... -a
	... (likewise for ||).

	* utils/csv2rec.c (parse_args): Use EXIT_* values.
	* utils/recutl.h: Likewise.
	* utils/recutl.c: Likewise.
	* utils/recset.c: Likewise.
	* utils/recsel.c: Likewise.
	* utils/recins.c: Likewise.
	* utils/recinf.c: Likewise.
	* utils/recfix.c: Likewise.
	* utils/recdel.c: Likewise.
	* utils/mdb2rec.c: Likewise.
	* src/rec-types.c: Likewise.
	* src/rec-sex.c: Likewise.

2010-11-01  Jose E. Marchesi  <jemarch@gnu.org>

	Make distcheck to work.
	* doc/recutils.texi: Include version.texi.

	* doc/Makefile.am (TEXI_TEXINFOS): Added getdate.texi.

	* torture/rec-mset/rec-mset-count.c: Include
	rec-mset/elem-types.h.
	* torture/rec-mset/rec-mset-type-p.c: Likewise.
	* torture/rec-mset/rec-mset-register-type.c: Likewise.
	* torture/rec-mset/rec-mset-dup.c: Likewise.

	* torture/Makefile.am (AM_CPPFLAGS): -I$(top_srcdir)/torture
	added.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	Warnings removed in the codebase.
	* src/rec-sex.c: Include rec-utils.h.

	* src/rec-sex.l: Include rec-utils.h.

	* src/rec-types.c (rec_type_new): Missing cases REC_TYPE_DATE and
	REC_TYPE_EMAIL added.
	Include rec-utils.h for rec-atoi.
	(rec_type_parse_regexp): Unused variable 'b' removed.
	(rec_type_descr_field_name): Likewise.
	(rec_type_new): Likewise.
	(rec_type_parse_size): Unused variable 'ret' removed.
	(rec_type_parse_regexp_type): Unused variable 'escaping' removed.

	* src/rec-fex.c: Include rec-utils.h for rec-atoi.
	Unused static function rec_fex_parse_int removed.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	Coverage report generation.
	* build-aux/generate-coverage-report: New file, from libgnupdf.

	* configure.ac: Support the --enable-coverage switch.

	* src/Makefile.am (AM_CFLAGS): Add coverage gcc options if
	compiling the library with coverage support.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	rec-type-reg unit tests and bug fixes.
	* torture/rec-type-reg/rec-type-reg-get.c: New file.
	(test_rec_type_reg_get): New function.
	(rec_type_reg_get_nominal): New test.
	(rec_type_reg_get_nonexisting): New test.

	* torture/rec-type-reg/rec-type-reg-register.c: New file.
	(test_rec_type_reg_register): New function.
	(rec_type_reg_register_nominal): New test.

	* torture/rec-type-reg/rec-type-reg-destroy.c: New file.
	(test_rec_type_reg_destroy): New function.
	(rec_type_reg_destroy_nominal): New test.

	* torture/rec-type-reg/rec-type-reg-new.c: New file.
	(test_rec_type_reg_new): New function.
	(rec_type_reg_new_nominal): New test.

	* torture/rec-type-reg/tsuite-rec-type-reg.c: New file.
	(tsuite_rec_type_reg): New function.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	rec-type unit tests and bug fixes.
	* torture/rec-type/rec-type-check.c: New file.
	(test_rec_type_check): New function.
	(rec_type_check_int): New test.
	(rec_type_check_bool): New test.
	(rec_type_check_range): New test.
	(rec_type_check_real): New test.
	(rec_type_check_size): New test.
	(rec_type_check_line): New test.
	(rec_type_check_regexp): New test.
	(rec_type_check_date): New test.
	(rec_type_check_enum): New test.
	(rec_type_check_field): New test.
	(rec_type_check_email): New test.

	* torture/rec-type/rec-type-equal-p.c: New file.
	(test_rec_type_equal_p): New function.
	(rec_type_equal_p_nominal): New test.

	* torture/rec-type/rec-type-kind-str.c: New file.
	(test_rec_type_kind_str): New function.
	(rec_type_kind_str_nominal): New test.

	* torture/rec-type/rec-type-kind.c: New file.
	(test_rec_type_kind): New function.
	(rec_type_kind_nominal): New test.

	* torture/rec-type/rec-type-descr-field-name.c: New file.
	(test_rec_type_descr_field_name): New function.
	(rec_type_descr_field_name_nominal): New test.
	(rec_type_descr_field_name_invalid): New test.

	* torture/rec-type/rec-type-descr-p.c: New file.
	(test_rec_type_descr_p): New function.
	(rec_type_descr_p_nominal): New test.
	(rec_type_descr_p_invalid): New test.

	* torture/rec-type/rec-type-destroy.c: New file.
	(test_rec_type_destroy): New function.
	(rec_type_destroy_nominal): New test.

	* torture/rec-type/rec-type-new.c: New file.
	(test_rec_type_new): New function.
	(rec_type_new_nominal): New test.
	(rec_type_new_invalid): New test.

	* torture/rec-type/tsuite-rec-type.c: New file.
	(tsuite_rec_type): New function.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	rec-field-name unit tests and bug fixes.
	* TESTS: Regenerated.

	* torture/rec-field-name/rec-field-name-part-normalise.c: New
	file.
	(test_rec_field_name_part_normalise): New function.
	(rec_field_name_part_normalise_nominal): New test.

	* torture/rec-field-name/rec-field-name-str-p.c: New file.
	(test_rec_field_name_str_p): New function.
	(rec_field_name_str_p_nominal): New test.

	* torture/rec-field-name/rec-field-name-part-str-p.c: New file.
	(test_rec_field_name_part_str_p): New function.
	(rec_field_name_part_str_p_nominal): New test.

	* torture/rec-field-name/rec-field-name-get.c: New file.
	(test_rec_field_name_get): New function.
	(rec_field_name_get_nominal): New test.

	* torture/rec-field-name/rec-field-name-set.c: New file.
	(test_rec_field_name_set): New function.
	(rec_field_name_set_nominal): New test.

	* torture/rec-field-name/rec-field-name-size.c: New file.
	(test_rec_field_name_size): New function.
	(rec_field_name_size_empty): New test.
	(rec_field_name_size_nonempty): New test.

	* torture/rec-field-name/rec-field-name-ref-p.c: New file.
	(test_rec_field_name_ref_p): New function.
	(rec_field_name_ref_p_empty): New test.
	(rec_field_naem_ref_p_nonempty): New test.

	* torture/rec-field-name/rec-field-name-equal-p.c: New file.
	(test_rec_field_name_equal_p): New function.
	(rec_field_name_equal_p_empty): New test.
	(rec_field_name_equal_p_nonempty): New test.

	* torture/rec-field-name/rec-field-name-eql-p.c: New file.
	(test_rec_field_name_eql_p): New function.
	(rec_field_name_eql_p_empty): New test.
	(rec_field_naem_eql_p_nonempty): New test.

	* torture/rec-field-name/rec-field-name-dup.c: New file.
	(test_rec_field_name_dup): New function.
	(rec_field_name_dup_empty): New test.
	(rec_field_name_dup_nominal): New test.

	* torture/rec-field-name/rec-field-name-destroy.c: New file.
	(test_rec_field_name_destroy): New function.
	(rec_field_name_destroy_nominal): New test.

	* torture/rec-field-name/tsuite-rec-field-name.c: New file.

	* torture/rec-field-name/rec-field-name-new.c: New file.
	(test_rec_field_name_new): New function.
	(rec_field_name_new_nominal): New test.

2010-10-29  Jose E. Marchesi  <jemarch@gnu.org>

	rec-comment unit tests and bug fixes.
	* TESTS: regenerated.

	* src/rec-comment.c (rec_comment_new): Check for a NULL argument.

	* torture/rec-comment/rec-comment/equal-p.c: New file.
	(test_rec_comment_equal_p): New function.
	(rec_comment_equal_p_nominal): New test.

	* torture/rec-comment/rec-comment-set-text.c: New file.
	(test_rec_comment_set_text): New function.
	(rec_comment_set_text_nominal): New test.

	* torture/rec-comment/rec-commment-text.c: New file.
	(test_rec_comment_text): New function.
	(rec_comment_text_nominal): New test.
	(rec_comment_text_empty): New test.

	* torture/rec-comment/rec-comment-dup.c: New file.
	(test_rec_comment_dup): New function.
	(rec_comment_dup_nominal): New test.

	* torture/rec-comment/rec-comment-new.c: New file.
	(test_rec_comment_new): New function.
	(rec_comment_new_nominal): New test.
	(rec_comment_new_null): New test.

	* torture/rec-comment/rec-comment-destroy.c: New file.
	(test_rec_comment_destroy): New function.
	(rec_comment_destroy_nominal): New test.

	* torture/runtests.c (main): rec-comment test suite added.

	* torture/Makefile.am: rec-comment files added.

	* torture/rec-comment/tsuite-rec-comment.c: New file.
	(tsuite_rec_comment): New function.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Regenerate TESTS.
	* TESTS: Regenerated.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Unit tests for rec_mset_get.
	* torture/rec-mset/rec-mset-get.c: New file
	(test_rec_mset_get): New function.
	(rec_mset_get_empty): New test.
	(rec_mset_get_existing): New test.
	(rec_mset_get_any): New test.
	(rec_mset_get_invalid): New test.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Unit tests for rec_mset_count.
	* torture/rec-mset/rec-mset-count.c: New file.
	(test_rec_mset_count): New function.
	(rec_mset_count_empty): New test.
	(rec_mset_count_existing): New test.
	(rec_mset_count_nonexisting): New test.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Unit tests for rec_mset_register_type.
	* torture/rec-mset/rec-mset-register-type.c: New file.
	(test_rec_mset_register_type): New function.
	(rec_mset_register_type_nominal): New test.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Unit tests for rec_mset_type_p.
	* torture/rec-mset/rec-mset-type-p.c: New file.
	(test_rec_mset_type_p): New function.
	(rec_mset_type_p_any): New test.
	(rec_mset_type_p_existing): New test.
	(rec_mset_type_p_nonexisting): New test.

	* torture/rec-mset/elem-types.h: New file.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Unit tests for rec_mset_dup, and a bug fixed.
	* src/rec-mset.c (rec_mset_dup): Avoid duplicating the counter of
	nodes of the element types.

	* torture/Makefile.am (REC_MSET_TSUITE): rec-mset-dup.c added.

	* torture/rec-mset/rec-mset-dup.c: New file.
	(test_rec_mset_dup): New function.
	(rec_mset_dup_empty): New test.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	rec_mset test suite.
	* torture/runtests.c: rec_mset test suite added.

	* torture/Makefile.am: Include files from the rec_mset test suite.

	* torture/rec-mset/rec-mset-new.c: New file.
	(rec_mset_new_and_destroy): New unit test.

	* torture/rec-mset/tsuite-rec-mset.c: New file.
	(tsuite_rec_mset): New function.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	* tasktool (tt_db_template_header): New variable.
	(tt_db_template_issue): New variable.
	(tt_db_template): Use tt_db_template_header and tt_db_template_issue.
	(tt_db_wish): New variable.
	(tt_db_wish_id): New variable.
	(tt_db_wish_summary): New variable.
	(tt_db_wish_description): New variable.

2010-10-28  Jose E. Marchesi  <jemarch@gnu.org>

	Documentation improvements.
	* utils/recset.c (recutl_print_help): Don't duplicate the
	--case-insensitive option in the output of --help.

	* utils/recinf.c (recutl_print_help): Print a newline before the
	examples in the output of --help.

	* doc/recutils.texi: Documentation for recdel, recins, recset and
	recfix added to the reference manual.

2010-10-25  Jose E. Marchesi  <jemarch@gnu.org>

	User manual work.
	* doc/recutils.texi (Fields and Records): Wording improvements.
	(Escalar types): Completed.
	(String types): Completed.
	(Time related types): Completed.
	(recinf Invocation): Document -S|--print-sexps.

	* doc/recutils.texi (Top): Improve the menu layout.

2010-10-24  Jose E. Marchesi  <jemarch@gnu.org>

	i18n with gettext.
	* m4/gettext.m4: Upgrade to gettext-0.18.1.
	* m4/iconv.m4: Upgrade to gettext-0.18.1.
	* m4/lib-ld.m4: Upgrade to gettext-0.18.1.
	* m4/lib-link.m4: Upgrade to gettext-0.18.1.
	* m4/progtest.m4: Upgrade to gettext-0.18.1.
	* configure.ac (AM_GNU_GETTEXT_VERSION): Bump to 0.18.1.

	* src/Makefile.am (librec_la_SOURCES): Add rec.c.

	* src/rec-fex.c: Internationalize strings with gettext.
	* src/rec-types.c: Likewise.
	* src/rec-parser.c: Likewise.
	* src/rec-int.c: Likewise.
	* src/rec-field-name.c: Likewise.
	* utils/recutl.c: Likewise.
	* utils/recset.c: Likewise.
	* utils/recsel.c: Likewise.
	* utils/recins.c: Likewise.
	* utils/recinf.c: Likewise.
	* utils/recdel.c: Likewise.
	* utils/mdb2rec.c: Likewise.
	* utils/csv2rec.c: Likewise.

	* Makefile.am (SUBDIRS): Add po.

2010-09-23  Jose E. Marchesi  <jemarch@gnu.org>

	* configure.ac: Invoke AB_INIT.

2010-09-19  Jose E. Marchesi  <jemarch@gnu.org>

	Simple fix in --help.
	* utils/recutl.h (COMMON_ARGS_DOC): Don't mention recsel in the
	description of the --version option.

2010-09-14  Jose E. Marchesi  <jemarch@gnu.org>

	rec-mode: make C-a to do the right thing.
	* lisp/rec-mode.el (rec-mode-map): Bind C-a to
	rec-cmd-beginning-of-line.
	(rec-mode-edit-map): Likewise.
	(rec-cmd-beginning-of-line): New function.

2010-09-09  Jose E. Marchesi  <jemarch@gnu.org>

	Support for localization on lisp output.
	* src/rec-record.c: New fiels 'char_location' and
	'char_location_str' in the 'rec_record_s' struct.

	* src/rec-parser.c (rec_parse_field): Set the char location of
	fields.
	(rec_parser_ungetc): Decrease parser->character.

	* src/rec-field.c: New functions 'rec_field_char_location',
	'rec_field_set_char_location' and 'rec_field_char_location_str'.

	* src/rec-parser.c: Use size_t instead of int for the 'line' field
	of the rec_parser_s structure.
	(rec_parser_getc): Update parser->character as well.
	(rec_parser_new): Initialize parser->character to 0.

2010-09-09  Jose E. Marchesi  <jemarch@gnu.org>

	Support for lisp output.
	* utils/recinf.c: Support the -S option.

	* utils/recsel.c: Likewise.

	* src/rec-writer.c (rec_write_record): New 'mode' argument.
	(rec_write_field_name): Likewise.
	(rec_write_field): Likewise.
	(rec_write_field_str): Likewise.

	* src/rec.h: New function.
	(rec_writer_mode_t): New data type.

2010-09-02  Jose E. Marchesi  <jemarch@gnu.org>

	Little doc improvements.
	* doc/recutils.texi: Little doc improvements.

2010-08-24  Jose E. Marchesi  <jemarch@gnu.org>

	fixes in the parsing of types.
	* src/rec-int.c (rec_int_check_descriptor): Localize the error in
	the concrete field.

	* src/rec-types.c: Parsing routines rewritten.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-types.c (rec_type_skip_blanks): New function.
	(rec_type_descr_field_name): Use rec_type_skip_blanks.
	(rec_type_new): Likewise.
	(rec_type_parse_int): New function.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.org>

	rec-sex: support for real values in some operators.
	* src/rec-sex.c (rec_sex_op_real_p): New function.
	(ATOF_VAL): New macro.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.org>

	utilities: use xmalloc and xstrdup.
	* utils/csv2rec.c: Use xmalloc instead of malloc.
	Use xstrdup instead of strdup.
	Include xalloc.h.

	* utils/recutl.h: Likewise.

	* utils/recutl.c: Likewise.

	* utils/recset.c: Likewise.

	* utils/recins.c: Likewise.

	* utils/mdb2rec.c: Likewise.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.org>

	mdb2rec: documentation and management of money fields.
	* utils/mdb2rec.c (process_table): Declare MONEY fields as real
	values.

	* doc/recutils.texi (mdb2rec Examples): Written.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.org>

	rec-types: support for the 'field' type.
	* src/rec-types.c (REC_TYPE_FIELD_NAME): Defined.
	(REC_TYPE_FIELD_VALUE_RE): Defined in terms of REC_FNAME_RE.
	(REC_TYPE_NAME_RE): REC_TYPE_FIELD_NAME added.
	(REC_TYPE_FIELD_DESCR_RE): Defined.
	(REC_TYPE_DESCR_RE): REC_TYPE_FIELD_DESCR_RE added.
	(rec_type_kind_str): Added case for REC_TYPE_FIELD.
	(rec_type_check): Likewise.
	(rec_type_parse_type_kind): Likewise.
	(rec_type_check_field): New function.

	* src/rec.h (REC_FNAME_RE): Do not include anchors in regexp.

2010-08-23  Jose E. Marchesi  <jemarch@gnu.com>

	mdb2rec: specification of the table in the command line and the
	list-tables option.
	* doc/recutils.texi (mdb2rec Invocation): Document the
	--list-tables command line option.

	* utils/mdb2rec.c (process_mdb): Print the names of the tables,
	one per line, if mdb2rec_list_tables was specified.

	* doc/recutils.texi (mdb2rec Invocation): Document the usage of
	TABLE in the command line.

	* utils/mdb2rec.c: New global variable 'mdb2rec_mdb_table'.
	(parse_args): Set mdb2rec_mdb_table.
	(process_mdb): Process the requested table only if
	mdb2rec_mdb_table is initialized.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	mdb2rec: emit field types for VARCHAR columns.
	* src/rec-types.c (rec_type_new): Finish the number[] string with
	a null value.

	* utils/mdb2rec.c (process_table): Process case when col_size > 0.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	rec-int: warn on colling types only if the types are different.
	* src/rec-int.c (rec_int_check_field_type): Emit warning on
	colliding types only if the types are not equal.

	* src/rec-types.c (rec_type_equal_p): New function.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	mdb2rec: use compound field names to reflect relationships between
	columns in the mdb tables.
	* utils/mdb2rec.c (get_field_name): New function.
	(process_table): Use 'get_field_name'.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	manual: texinfo fixes.
	* doc/recutils.texi: mdb2rec is a chapter.
	Fix mdb2rec menu.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	build: advertise third-party dependencies.
	* README-dev: Add a note on the dependencies on third party
	products.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	Validation of record type names and minor fixes.
	* utils/mdb2rec.c (process_table): Use
	'rec_field_name_part_normalise'.

	* src/rec-field-name.c (rec_field_name_part_normalise): New
	function.

	* utils/mdb2rec.c (process_mdb): Configure libmdb to dump dates in
	ISO 8601 format.

	* src/rec-int.c (rec_int_check_descriptor): Check for the validity
	of the record set type.

	* utils/recutl.h (RECORD_SELECTION_ARGS_CASES): Check for the
	validity of the record types passed using -t.

	* src/rec.h: New function 'rec_field_name_str_p'.
	New function 'rec_field_name_part_str_p'.
	(REC_FNAME_PART_RE): Defined.
	(REC_FNAME_RE): Defined.

	* src/rec-field-name.c (rec_field_name_str_p): New function.
	(rec_field_name_part_str_p): New function.

	* doc/recutils.texi (Record Descriptors): Clarify that the record
	types have the same format restrictions that field names.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	build: check for glib as a dependency to build mdb2rec.
	* configure.ac: Check for glib.

	* utils/mdb2rec.c: Include glib.h.

2010-08-22  Jose E. Marchesi  <jemarch@gnu.org>

	mdb2rec: normalize field names and new option to keep empty fields
	in the rec output.
	* doc/recutils.texi (mdb2rec Invocation): Document '-e'.

	* utils/mdb2rec.c (parse_args): Manage '-e'.
	(process_table): Normalize field names.

2010-08-21  Jose E. Marchesi  <jemarch@gnu.org>

	utils: new util mdb2rec.
	* src/rec-writer.c (rec_write_rset): Manage special case: empty
	record sets with a record descriptor.

	* src/rec.h: New function 'rec_field_new_str'.

	* src/rec-field.c (rec_field_new_str): Idem.

2010-08-20  Jose E. Marchesi  <jemarch@gnu.org>

	* configure.ac: Search for libmdbtools and define MDBLIBS.

	* utils/Makefile.am: Build mdb2rec.

	* utils/mdb2rec.c: New file.

2010-08-20  Jose E. Marchesi  <jemarch@gnu.org>

	csv2rec: several minor fixes.
	* utils/csv2rec.c (main): Make sure a rec database was created
	before to attempt to write it.

	* configure.ac: Emit a warning if libcsv is not found, noticing
	the user that csv2rec won't build.

2010-08-20  Jose E. Marchesi  <jemarch@gnu.org>

	Fixing of memory errors.
	* src/rec-sex.c (rec_sex_eval_node): Free the memory used by the
	compiled regexps.

	* utils/recfix.c (main): Free the memory used by the rec database.

	* utils/recsel.c (main): Likewise.

	* utils/recsel.c (recsel_process_data): Free the memory used by
	the rec writer.

	* src/rec-parser.c (rec_parser_buf_adjust): Realloc to adjust the
	memory used by the buffer.

	* src/rec-sex.l (rec_sex_lex_extract_name): Avoid an invalid write
	after the res[] buffer.

2010-08-20  Jose E. Marchesi  <jemarch@gnu.org>

	utils: new util csv2rec.
	* doc/recutils.texi (csv2rec): New chapter.

	* configure.ac: Check for libcsv and define the LIBCSV automake
	conditional accondingly.

	* utils/Makefile.am (bin_PROGRAMS): csv2rec added.
	(csv2rec_SOURCES): New variable.
	(csv2rec_LDADD): New variable.

	* utils/csv2rec.c: New file.

2010-08-20  Jose E. Marchesi  <jemarch@gnu.org>

	build: fix autogen.sh.
	* autogen.sh: Call libtoolize.
	Invoke automake with --add-missing.

2010-08-09  Jose E. Marchesi  <jemarch@gnu.org>

	Little script to get cyclomatic metrics from pmccabe.
	* build-aux/pmccabe2rec: New file.

2010-08-08  Jose E. Marchesi  <jemarch@gnu.org>

	Fix source in parse error messages in recinf.
	* utils/recinf.c (print_info_file): Specify the file name in parse
	errors instead of 'stdin'.

2010-08-08  Jose E. Marchesi  <jemarch@gnu.org>

	Generate information about tests in rec format and store it in
	TESTS.
	* README-dev: Added a note on updating the TESTS file when a test
	is added to the test suite.

	* TESTS (Test): New file, generated ith 'get-test-data'.

	* build-aux/get-test-data: New file.

	* torture/rec-record/rec-record-size.c: rec_record_size_001
	renamed to rec_record_size_empty.
	rec_record_size_002 renamed to rec_record_size_nonempty.
	(test_rec_record_size): Call to rec_record_size_empty and
	rec_record_size_nonempty.

	* torture/rec-record/rec-record-remove-field.c:
	rec_record_remove_field_001 renamed to
	rec_record_remove_field_existing.
	(test_rec_record_remove_field): Call to
	rec_record_remove_field_existing.

	* torture/rec-record/rec-record-new.c: rec_record_new_001 renamed
	to rec_record_new_and_destroy.

	* torture/rec-record/rec-record-insert-field.c:
	rec_record_insert_field_001 renamed to
	rec_record_insert_field_empty.
	rec_record_insert_field_002 renamed to
	rec_record_insert_field_nonempty.
	rec_record_insert_field_003 renamed to
	rec_record_insert_field_duplicated.
	(test_rec_record_insert_field): Call
	rec_record_insert_field_empty, rec_record_insert_field_nonempty
	and rec_record_insert_field_duplicated.

	* torture/rec-record/rec-record-field-p.c: rec_record_field_p_001
	renamed to rec_record_field_existing.
	rec_record_field_p_002 renamed to rec_record_field_nonexisting.

	* torture/rec-field/rec-field-value.c: rec_field_value_001 renamed
	to rec_field_value_empty.
	rec_field_value_002 renamed to rec_field_value_nonempty.
	(test_rec_field_value): Call to rec_field_value_empty and
	rec_field_value_nonempty.

	* torture/rec-field/rec-field-set-value.c: rec_field_set_value_001
	renamed to rec_field_set_value_empty.
	rec_field_set_value_002 renamed to rec_field_set_value_nonempty.
	(test_rec_field_set_value): Call to rec_field_set_value_empty and
	rec_field_set_value_nonempty.

	* torture/rec-field/rec-field-set-name.c: rec_field_set_name_001
	renamed to rec_field_set_name_empty.
	rec_field_set_name_002 renamed to rec_field_set_name_nonempty.
	(test_rec_field_set_name): Call to rec_field_set_name_empty and
	rec_field_set_name_nonempty.

	* torture/rec-field/rec-field-name.c: rec_field_name_001 renamed
	to rec_field_name_empty.
	rec_field_name_002 renamed to rec_field_name_nonempty.
	(test_rec_field_name): Call to 'rec_field_name_empty' and
	'rec_field_name_nonempty'.
	Comments reformatted to contain rec data.

	* torture/rec-field/rec-field-dup.c: rec_field_dup_001 renamed to
	rec_field_dup_empty.
	rec_field_dup_002 renamed to rec_field_dup_nonempty.
	(test_rec_field_dup): Call to 'rec_field_dup_empty' and
	'rec_field_dup_nonempty'.
	Comments reformated to contain rec data.

2010-08-07  Jose E. Marchesi  <jemarch@gnu.org>

	Import the gnulib gettext module.
	* 'gettext' gnulib module imported.

2010-08-06  Jose E. Marchesi  <jemarch@gnu.org>

	Minor fixes in documentation.
	* src/rec-int.c (rec_int_check_field_type): Out to date comment
	removed.

	* doc/recutils.texi (Field Types): New chapter.
	(Escalar types): New section.
	(String types): New section.
	(Enumerated types): New section.
	(Time related types): New section.
	(Selection Expressions): New section.

2010-08-05  Jose E. Marchesi  <jemarch@gnu.org>

	Assure proper exit values when redirecting output and some common
	facilities in recutl.c
	* utils/recset.c (recset_parse_args): Use 'recutl_fatal' and
	'recutl_error'.
	(main): Use 'recutl_init'.

	* utils/recins.c (recins_insert_record): Use 'recutl_error'.
	(main): Use 'recutl_init'.

	* utils/recinf.c (main): Use 'recutl_init'.

	* utils/recfix.c (main): Use 'recutl_init'.

	* utils/recdel.c (recdel_delete_records): Use 'recutl_fatal'.
	(recdel_delete_records): Likewise.
	(recdel_parse_args): Likewise.
	(main): Use 'recutl_init'.

	* utils/recsel.c (main): Use 'recutl_init'.

	* utils/recutl.c (recutl_error): New function.

	* utils/recsel.c (recsel_parse_args): Use 'recutl_fatal'.
	(recsel_parse_args): Likewise.
	(recsel_process_data): Use 'recutl_error'.

	* utils/recutl.c: Include 'closeout.h'.
	(recutl_init): New function.
	(recutl_init): Initialize the global variable 'program_name' with
	'util_name'.
	(recutl_init): Install the 'close_stdout' handler to be executed
	upon exit.
	(recutl_fini): New function.
	(recutl_fatal): New function.
	Include stdarg.

	* Module 'closeout' imported from gnulib.

2010-08-05  Jose E. Marchesi  <jemarch@gnu.org>

	* README-dev: Imported and adapted from GNU hello.

	* NEWS: Likewise.

	* README: Rephrased to follow the GNU hello style.

	* configure.ac: Invoke AC_PROG_YACC.

	* autogen.sh: Imported and adapted from GNU hello.

2010-08-02  Jose E. Marchesi  <jemarch@gnu.org>

	lib+utils: check the values returned by malloc.
	* src/rec-field.c (rec_field_set_location): Check for the return
	value of 'malloc'.

	* src/rec-parser.c (rec_parser_perror): Likewise.

	* src/rec-parser.c (rec_parse_field_name_str): Likewise.

	* src/rec-record.c (rec_record_set_location): Likewise.

	* utils/recins.c (recins_parse_args): Likewise.

	* utils/recutl.c (recutl_write_db_to_file): Likewise.

	* src/rec-fex.c (rec_fex_check): Emit error message only if there
	is enough memory to build the message.
	(rec_fex_parse_str_simple): Check for the return value of
	'malloc'.
	(rec_fex_parse_str_subscripts): Likewise.
	(rec_fex_parse_elem): Likewise.

2010-08-01  Jose E. Marchesi  <jemarch@gnu.org>

	recutl: avoid printing spurious newline characters when -P or -R
	is used.
	* utils/recutl.c (recutl_eval_field_expression): New variable
	'written_field'.
	(recutl_eval_field_expression): Add a newline to a sequence of
	field values only if some field was actually written.

	rec-record: Tiny improvement in an algorithm.
	* src/rec-record.c (rec_record_get_field_by_name): Don't return
	from the middle of the function.  Use a variable and break
	instead.

	recsel: allow dashes in field names when checking the field
	expressions.
	* src/rec-fex.c (rec_fex_check): Allow dashes '-' in field names
	in field expressions.

	recsel: avoid a segmentation fault while printing record descriptors.
	* utils/recsel.c (recsel_process_data): Test for NULL before
	printing the record descriptor of a record set.  Reported by Kai
	via savannah.

2010-07-31  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Fix distcheck: linking tests in torture/.
	* torture/Makefile.am: Simplify.  Use relative path to librec.la
	so dependencies are tracked correctly and distcheck works.

2010-07-31  Jose E. Marchesi  <jemarch@gnu.org>

	Information for the Free Software Directory added in FSD.
	* FSD (Description): New file.

	Make git to ignore some more generated files.
	* .gitignore: Ignore doc/recutils.aux, doc/recutils.cp, doc/recutils.cps,
	doc/recutils.fn, doc/recutils.fns, doc/recutils.ky,
	doc/recutils.log, doc/recutils.pg,
	doc/recutils.toc, doc/recutils.tp, doc/recutils.vr and
	doc/recutils.vrs.
	Ignore lib/alloca.h, lib/c++defs.h, lib/stdlib.h, lib/string.h,
	lib/sys, lib/time.h, lib/warn-on-use.h, lib/wchar.h.
	Ignore torture/test

2010-07-30  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	Simplify makefile rules.
	* utils/Makefile.am: Simplify.
	* src/Makefile.am: Likewise.

	Typos and formatting nits.
	* configure.ac: Fix typo.
	* doc/recutils.texi: Fix typo, add some @noindents.

2010-07-30  Jose E. Marchesi  <jemarch@gnu.org>

	* gendocs gnulib module imported.

2010-07-25  Jose E. Marchesi  <jemarch@gnu.org>

	Manual: misc improvements.
	* doc/recutils.texi: Misc improvements.

2010-07-25  Jose E. Marchesi  <jemarch@gnu.org>

	GHM 2010 slides.
	* doc/recutils.ept: New file.

2010-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	Parametrize the name of the fields in the issues.
	* tasktool: New variables containing the names of the issue
	fields: tt_db_field_id, tt_db_field_summary, tt_db_field_type,
	tt_db_field_status, tt_db_field_originator, tt_db_field_assignee,
	tt_db_field_assigned, tt_db_field_component, tt_db_field_created,
	tt_db_field_note, tt_db_field_description.
	(tt_db_template): Use the variables described above.
	(tt_version): Likewise.
	(tt_version): Likewise.
	(tt_version): Likewise.
	(tt_supported_vcs): Likewise.
	(tt_supported_vcs): Likewise.

2010-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	Avoid build dependency with bison.
	* lib/getdate.c: New file.

	* build-aux/.gitignore: Ignore ylwrap.

2010-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	Integrate getdate documentation in the manual.
	* doc/recutils.texi (Top): Entry for the "Date input formats"
	chapter added.
	Include 'getdate.texi'.
	FSF copyright added in the manual.

2010-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	Implementation of the 'date' field type.
	* tasktool (tt_db_template): Declare Date as a field of type
	'date'.

	* src/Makefile.am (librec_la_LIBADD): LIB_CLOCK_GETTIME added to
	find the definition of 'clock_gettime'.

	* src/rec-types.c (rec_type_check_date): Implemented using
	'get_date'.
	Include getdate.h.

2010-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	Gnulib work.
	* Gnulib updated.

	* Module 'getdate' imported.

2010-07-18  Jose E. Marchesi  <jemarch@gnu.org>

	Localization of fields and better error reporting.
	* src/rec-int.c (rec_int_check_record_types): Improve error
	localization.

	* utils/recutl.c (recutl_parse_db_from_file): Report parse errors.

	* src/rec-int.c (rec_int_check_field_type): Use localization
	information in the warning.

	* src/rec-parser.c (rec_parse_field): Annotate the fields with
	their location in the source file.

	* src/rec-field.c (rec_field_destroy): Free memory occupied by the
	location properties upon field destruction.

	* src/rec.h: New functions 'rec_field_source',
	'rec_field_set_source', 'rec_field_location',
	'rec_field_set_location' and 'rec_field_location_str'.

	* src/rec-field.c: Implementation of the functions listed above.

2010-07-18  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-int.c: Copyright notification added.

2010-07-15  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-field-name.c (rec_field_name_ref_p): New function.

	* src/rec-int.c (rec_int_check_rset): Pass 'db' to
	'rec_rset_elem_record'.

	* utils/recins.c (recins_insert_record): Pass the database
	containing the rset containing the record to 'rec_int_check_rset'.

	* utils/recset.c (recset_process_actions): Likewise.

	* src/rec.h: 'rec_int_check_rset' gets a parameter (optional using
	NULL) 'db'.
	Likewise for 'rec_int_check_record'.
	Likewise for 'rec_int_check_field_type'.

	* src/rec-int.c (rec_int_check_rset): Likewise.

2010-07-15  Jose E. Marchesi  <jemarch@gnu.org>

	New function re_int_check_db to check the integrity of a database.
	* utils/recfix.c (recfix_process_data): Use 'rec_int_check_db'.

	* src/rec-int.h: New function 'rec_int_check_db'.

	* src/rec-int.c (rec_int_check_db): New function.

2010-07-15  Jose E. Marchesi  <jemarch@gnu.org>

	Relocate data integrity related code to rec-int.c.
	* src/rec-int.c (rec_int_check_field_type): Use
	'rec_rset_get_type_reg' to get the type registry of records sets
	instead of accessing the data structure.

	* src/rec.h: New function 'rec_rset_get_type_reg'.

	* src/rec-rset.c (rec_rset_get_type_reg): New function.

	* src/Makefile.am (librec_la_SOURCES): 'rec-int.c' added.

	* utils/recfix.c (recfix_process_data): Use 'rec_int_check_rset'
	instead of 'rec_rset_check'.

	* utils/recins.c (recins_insert_record): Likewise.

	* utils/recset.c (recset_process_actions): Likewise.

	* src/rec-int.c: New file.

	* src/rec.h: 'rec_rset_check' renamed to 'rec_int_check_rset'.
	'rec_rset_check_record' renamed to 'rec_int_check_record'.
	'rec_rset_check_field_type' renamed to 'rec_int_check_field_type'.

2010-07-14  Jose E. Marchesi  <jemarch@gnu.com>

	Change -v|--verbose in recinf for -d|--descriptor.
	* utils/recinf.c (COMMON_ARGS): VERBOSE_ARG renamed to
	DESCRIPTOR_ARG.
	(print_info_file): Process the -d|--descriptor command line
	argument instead of -v|--verbose.

2010-07-14  Jose E. Marchesi  <jemarch@gnu.org>

	Support for the --type option in recinf.
	* utils/recinf.c (COMMON_ARGS): New argument 'TYPE_ARG'.
	(GNU_longOptions): New argument '--type'.
	(recutl_help_msg): Doc for the new argument 'type'.
	(recinf_type): New global variable.
	(print_info_file): If a type was specified at command line, skip
	records not having that type.

2010-07-14  Jose E. Marchesi  <jemarch@gnu.org>

	Keep the descriptor relative position when inserting records in an
	empty record set.
	* utils/recins.c (recins_insert_record): Take into account the
	descriptor relative position in the record set when inserting a
	record into an empty rset.

2010-07-14  Jose E. Marchesi  <jemarch@gnu.org>

	Little fixes in tasktool.
	* tasktool (tt_db_show_task): Use a selection expression implying
	that Id is an integer, not a string.
	(tt_supported_vcs): Typo fixed.

	* tasktool (tt_db_task_p): Likewise.

2010-07-14  Jose E. Marchesi  <jemarch@gnu.org>

	Fix a regression in the definition of the REC_TYPE_DESCR_RE
	regexp.
	* src/rec-types.c (REC_TYPE_DESCR_RE): Regexp fixed.

2010-07-13  Jose E. Marchesi  <jemarch@gnu.org>

	Support for the type 'field' removed.
	* src/rec-types.c: Data types, constants and functions removed for
	the 'field' type.

2010-07-13  Jose E. Marchesi  <jemarch@gnu.org>

	Bug preventing empty fields without a beginning space fixed.
	* src/rec-parser.c (rec_parse_field_name): If a newline is found
	terminating a field name then push it back to the input stream, so
	it will be part of the field value.

2010-07-13  Jose E. Marchesi  <jemarch@gnu.org>

	Keep information about the position of the record descriptor in a
	record set.
	* src/rec-rset.c (rec_rset_set_descriptor_pos): New function.
	(rec_rset_descriptor_pos): New function.
	(rec_rset_new): Initialize new->descriptor_pos to 0.
	(struct rec_rset_s): New field descriptor_pos.

	* src/rec.h: Prototypes for 'rec_rset_descriptor_pos' and
	'rec_rset_set_descriptor_pos'.

	* src/rec-parser.c (rec_parse_rset): New local variable to store
	the number of comments added to the record set.  In the special
	case where some comments are preceding the first record descriptor
	in the file, store the relative position of the descriptor in the
	record set using rec_rset_descriptor_pos.

	* src/rec-writer.c (rec_write_rset): Write the descriptor in its
	relative position into the record set.

2010-06-19  Jose E. Marchesi  <jemarch@gnu.org>

	* utils/recins.c: Help string improved.

2010-04-30  Jose E. Marchesi  <jemarch@gnu.org>

	* lisp/rec-mode.el (rec-count): New implementation based on
	'recsel'.

2010-04-28  Jose E. Marchesi  <jemarch@gnu.org>

	* .gitignore: Ignore /utils/recfix.

2010-04-22  Jose E. Marchesi  <jemarch@gnu.org>

	* utils/recset.c (recset_parse_args): Stop the program with an
	error code if an invalid option is specified in the command line.
	(recset_process_actions): SET action implemented.

2010-04-21  Jose E. Marchesi  <jemarch@gnu.org>

	* utils/recset.c: Help string completed with record selection
	options, fields selection options and actions.

	* doc/recutils.texi (Record Descriptors): Documentation for the
	record descriptor field '%order'.

2010-04-08  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-mset.c: Distribution terms added.

	* src/rec-mset.h: Likewise.

2010-04-07  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-mset.c (rec_mset_elem_next): Added the MSET parameter.
	Return the first element of the given type if ELEM is NULL.

2010-04-01  Jose E. Marchesi  <jemarch@gnu.org>

	* .gitignore: Ignore backup files.

2010-01-11  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-parser.c (rec_parse_field_name_str): New function.

2010-01-09  Jose E. Marchesi  <jemarch@gnu.org>

	* src/Makefile.am (librec_la_SOURCES): rec-sex.l added to the
	list.

	* src/rec-sex.y: New file.

	* src/rec-sex.l: New file.

2009-12-28  Jose E. Marchesi  <jemarch@gnu.org>

	* utils/recinf.h (HELP_ARG): New file.

	* utils/recinf.c: New file.

	* utils/Makefile.am (recinf_LDFLAGS): New file.

2009-12-23  Jose E. Marchesi  <jemarch@gnu.org>

	* lisp/rec-mode.el: New file.
	(rec-field-trim-value): New function.
	(rec-cmd-trim-field-value): New function.

2009-11-30  Jose E. Marchesi  <jemarch@gnu.org>

	* lisp/rec-mode.el (rec-beginning-of-record-pos): Don't signal an
	error if the buffer is empty.

2009-10-02  Jose E. Marchesi  <jemarch@gnu.org>

	* lisp/rec-mode.el: New file.

2009-10-01  Jose E. Marchesi  <jemarch@gnu.org>

	* src/rec-record.c (rec_record_new): Allow duplicates.

2009-09-03  Jose E. Marchesi  <jemarch@gnu.org>

	* src/grec.h: Comments clarified.

2009-07-23  Jose E. Marchesi  <jemarch@gnu.org>

	* doc/fdl.texi: New file.

	* doc/gnurec.texi: New file.

2009-07-13  Jose E. Marchesi  <jemarch@gnu.org>

	* torture/runtests.c (main): Use CK_ENV instead of CK_VERBOSE in
	srunner_run_all.

	* Begin of the change log.

Copyright 2009, 2010 Jose E. Marchesi

Copying and distribution of this file, with or without modification, are
permitted in any medium without royalty provided the copyright notice
and this notice are preserved.
